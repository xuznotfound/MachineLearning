使用设备: cuda
GPU型号: NVIDIA GeForce RTX 4090
GPU内存: 25.39 GB
训练集大小: 54000
验证集大小: 6000
测试集大小: 10000
创建模型...
无法导入torchinfo，跳过模型摘要
总参数: 1,471,850
可训练参数: 1,471,850
开始训练...

Epoch 1/50
--------------------------------------------------
训练 Loss: 2.2706, Acc: 62.92%
验证 Loss: 1.1286, Acc: 75.97%
学习率: 0.000885
✓ 保存最佳模型，验证准确率: 75.97%

Epoch 2/50
--------------------------------------------------
训练 Loss: 1.1607, Acc: 78.45%
验证 Loss: 1.1427, Acc: 81.37%
学习率: 0.000594
✓ 保存最佳模型，验证准确率: 81.37%

Epoch 3/50
--------------------------------------------------
训练 Loss: 1.0403, Acc: 83.01%
验证 Loss: 0.9534, Acc: 85.70%
学习率: 0.000260
✓ 保存最佳模型，验证准确率: 85.70%

Epoch 4/50
--------------------------------------------------
训练 Loss: 0.9664, Acc: 85.26%
验证 Loss: 0.8896, Acc: 87.42%
学习率: 0.000036
✓ 保存最佳模型，验证准确率: 87.42%

Epoch 5/50
--------------------------------------------------
训练 Loss: 0.9561, Acc: 85.90%
验证 Loss: 0.8732, Acc: 87.63%
学习率: 0.000025
✓ 保存最佳模型，验证准确率: 87.63%

Epoch 6/50
--------------------------------------------------
训练 Loss: 0.9347, Acc: 86.44%
验证 Loss: 0.8393, Acc: 88.25%
学习率: 0.000233
✓ 保存最佳模型，验证准确率: 88.25%

Epoch 7/50
--------------------------------------------------
训练 Loss: 0.9124, Acc: 87.43%
验证 Loss: 0.9297, Acc: 87.37%
学习率: 0.000563

Epoch 8/50
--------------------------------------------------
训练 Loss: 0.9011, Acc: 88.08%
验证 Loss: 0.9771, Acc: 87.42%
学习率: 0.000865

Epoch 9/50
--------------------------------------------------
训练 Loss: 0.8846, Acc: 88.35%
验证 Loss: 0.9063, Acc: 86.53%
学习率: 0.000999

Epoch 10/50
--------------------------------------------------
训练 Loss: 0.8558, Acc: 88.68%
验证 Loss: 0.8405, Acc: 88.38%
学习率: 0.000905
✓ 保存最佳模型，验证准确率: 88.38%

Epoch 11/50
--------------------------------------------------
训练 Loss: 0.8510, Acc: 89.12%
验证 Loss: 0.7842, Acc: 89.45%
学习率: 0.000625
✓ 保存最佳模型，验证准确率: 89.45%

Epoch 12/50
--------------------------------------------------
训练 Loss: 0.8362, Acc: 89.56%
验证 Loss: 0.7566, Acc: 88.97%
学习率: 0.000288

Epoch 13/50
--------------------------------------------------
训练 Loss: 0.8323, Acc: 89.71%
验证 Loss: 0.7702, Acc: 90.08%
学习率: 0.000049
✓ 保存最佳模型，验证准确率: 90.08%

Epoch 14/50
--------------------------------------------------
训练 Loss: 0.8094, Acc: 90.01%
验证 Loss: 0.7246, Acc: 90.62%
学习率: 0.000017
✓ 保存最佳模型，验证准确率: 90.62%

Epoch 15/50
--------------------------------------------------
训练 Loss: 0.8086, Acc: 90.30%
验证 Loss: 0.7713, Acc: 90.37%
学习率: 0.000207

Epoch 16/50
--------------------------------------------------
训练 Loss: 0.7899, Acc: 90.51%
验证 Loss: 0.7629, Acc: 89.62%
学习率: 0.000532

Epoch 17/50
--------------------------------------------------
训练 Loss: 0.7884, Acc: 90.37%
验证 Loss: 0.7539, Acc: 89.95%
学习率: 0.000842

Epoch 18/50
--------------------------------------------------
训练 Loss: 0.7778, Acc: 90.80%
验证 Loss: 0.7647, Acc: 89.35%
学习率: 0.000996

Epoch 19/50
--------------------------------------------------
训练 Loss: 0.7782, Acc: 90.87%
验证 Loss: 0.7599, Acc: 89.32%
学习率: 0.000922

Epoch 20/50
--------------------------------------------------
训练 Loss: 0.7775, Acc: 91.28%
验证 Loss: 0.7861, Acc: 89.77%
学习率: 0.000327

Epoch 21/50
--------------------------------------------------
训练 Loss: 0.7599, Acc: 91.35%
验证 Loss: 0.8127, Acc: 91.30%
学习率: 0.000317
✓ 保存最佳模型，验证准确率: 91.30%

Epoch 22/50
--------------------------------------------------
训练 Loss: 0.7502, Acc: 91.48%
验证 Loss: 0.7393, Acc: 91.08%
学习率: 0.000063

Epoch 23/50
--------------------------------------------------
训练 Loss: 0.7525, Acc: 91.58%
验证 Loss: 0.7282, Acc: 91.67%
学习率: 0.000010
✓ 保存最佳模型，验证准确率: 91.67%

Epoch 24/50
--------------------------------------------------
训练 Loss: 0.7452, Acc: 91.67%
验证 Loss: 0.7168, Acc: 92.28%
学习率: 0.000182
✓ 保存最佳模型，验证准确率: 92.28%

Epoch 25/50
--------------------------------------------------
训练 Loss: 0.7402, Acc: 91.74%
验证 Loss: 0.7050, Acc: 91.62%
学习率: 0.000500

Epoch 26/50
--------------------------------------------------
训练 Loss: 0.7389, Acc: 91.93%
验证 Loss: 0.7184, Acc: 91.20%
学习率: 0.000819

Epoch 27/50
--------------------------------------------------
训练 Loss: 0.7307, Acc: 91.95%
验证 Loss: 0.7342, Acc: 91.28%
学习率: 0.000991

Epoch 28/50
--------------------------------------------------
训练 Loss: 0.7273, Acc: 92.02%
验证 Loss: 0.7444, Acc: 90.58%
学习率: 0.000938

Epoch 29/50
--------------------------------------------------
训练 Loss: 0.7271, Acc: 92.27%
验证 Loss: 0.7106, Acc: 91.32%
学习率: 0.000684

Epoch 30/50
--------------------------------------------------
训练 Loss: 0.7213, Acc: 92.41%
验证 Loss: 0.6962, Acc: 91.62%
学习率: 0.000346

Epoch 31/50
--------------------------------------------------
训练 Loss: 0.7228, Acc: 92.33%
验证 Loss: 0.6821, Acc: 92.30%
学习率: 0.000079
✓ 保存最佳模型，验证准确率: 92.30%

Epoch 32/50
--------------------------------------------------
训练 Loss: 0.7131, Acc: 92.51%
验证 Loss: 0.6781, Acc: 92.53%
学习率: 0.000005
✓ 保存最佳模型，验证准确率: 92.53%

Epoch 33/50
--------------------------------------------------
训练 Loss: 0.7128, Acc: 92.64%
验证 Loss: 0.7060, Acc: 92.38%
学习率: 0.000159

Epoch 34/50
--------------------------------------------------
训练 Loss: 0.7112, Acc: 92.66%
验证 Loss: 0.6872, Acc: 92.50%
学习率: 0.000469

Epoch 35/50
--------------------------------------------------
训练 Loss: 0.7066, Acc: 92.71%
验证 Loss: 0.6917, Acc: 92.63%
学习率: 0.000794
✓ 保存最佳模型，验证准确率: 92.63%

Epoch 36/50
--------------------------------------------------
训练 Loss: 0.7055, Acc: 92.77%
验证 Loss: 0.6880, Acc: 91.60%
学习率: 0.000984

Epoch 37/50
--------------------------------------------------
训练 Loss: 0.7003, Acc: 93.05%
验证 Loss: 0.7030, Acc: 92.05%
学习率: 0.000952

Epoch 38/50
--------------------------------------------------
训练 Loss: 0.6998, Acc: 92.79%
验证 Loss: 0.7074, Acc: 91.28%
学习率: 0.000357

Epoch 39/50
--------------------------------------------------
训练 Loss: 0.6933, Acc: 93.11%
验证 Loss: 0.6927, Acc: 91.82%
学习率: 0.000376

Epoch 40/50
--------------------------------------------------
训练 Loss: 0.6968, Acc: 93.04%
验证 Loss: 0.6729, Acc: 92.48%
学习率: 0.000096

Epoch 41/50
--------------------------------------------------
训练 Loss: 0.6912, Acc: 93.06%
验证 Loss: 0.6786, Acc: 92.68%
学习率: 0.000002
✓ 保存最佳模型，验证准确率: 92.68%

Epoch 42/50
--------------------------------------------------
训练 Loss: 0.6881, Acc: 93.13%
验证 Loss: 0.6866, Acc: 92.93%
学习率: 0.000136
✓ 保存最佳模型，验证准确率: 92.93%

Epoch 43/50
--------------------------------------------------
训练 Loss: 0.6831, Acc: 93.34%
验证 Loss: 0.6754, Acc: 92.37%
学习率: 0.000438

Epoch 44/50
--------------------------------------------------
训练 Loss: 0.6842, Acc: 93.28%
验证 Loss: 0.6696, Acc: 92.60%
学习率: 0.000768

Epoch 45/50
--------------------------------------------------
训练 Loss: 0.6830, Acc: 93.31%
验证 Loss: 0.6789, Acc: 91.75%
学习率: 0.000976

Epoch 46/50
--------------------------------------------------
训练 Loss: 0.6776, Acc: 93.55%
验证 Loss: 0.6775, Acc: 92.23%
学习率: 0.000965

Epoch 47/50
--------------------------------------------------
训练 Loss: 0.6790, Acc: 93.46%
验证 Loss: 0.6963, Acc: 92.35%
学习率: 0.000741

Epoch 48/50
--------------------------------------------------
训练 Loss: 0.6723, Acc: 93.74%
验证 Loss: 0.6705, Acc: 92.25%
学习率: 0.000407

Epoch 49/50
--------------------------------------------------
训练 Loss: 0.6725, Acc: 93.64%
验证 Loss: 0.6660, Acc: 92.90%
学习率: 0.000116

Epoch 50/50
--------------------------------------------------
训练 Loss: 0.6688, Acc: 93.81%
验证 Loss: 0.6672, Acc: 93.02%
学习率: 0.000001
✓ 保存最佳模型，验证准确率: 93.02%

==================================================
最终测试
测试准确率: 93.39%
分类报告:
              precision    recall  f1-score   support

 T-shirt/top     0.8812    0.8830    0.8821      1000
     Trouser     0.9920    0.9860    0.9890      1000
    Pullover     0.8966    0.9100    0.9032      1000
       Dress     0.9273    0.9560    0.9414      1000
        Coat     0.8942    0.9130    0.9035      1000
      Sandal     0.9880    0.9840    0.9860      1000
       Shirt     0.8294    0.7680    0.7975      1000
     Sneaker     0.9699    0.9660    0.9679      1000
         Bag     0.9871    0.9970    0.9920      1000
  Ankle boot     0.9673    0.9760    0.9716      1000

    accuracy                         0.9339     10000
   macro avg     0.9333    0.9339    0.9334     10000
weighted avg     0.9333    0.9339    0.9334     10000


模型已保存，测试准确率: 93.39%

==================================================
可选：训练多个模型进行集成

训练集成模型 1/3
开始训练...

Epoch 1/30
--------------------------------------------------
训练 Loss: 1.9091, Acc: 66.48%
验证 Loss: 1.0513, Acc: 81.73%
学习率: 0.000004
✓ 保存最佳模型，验证准确率: 81.73%

Epoch 2/30
--------------------------------------------------
训练 Loss: 1.0875, Acc: 81.12%
验证 Loss: 1.0682, Acc: 82.33%
学习率: 0.000989
✓ 保存最佳模型，验证准确率: 82.33%

Epoch 3/30
--------------------------------------------------
训练 Loss: 0.9744, Acc: 84.38%
验证 Loss: 0.8864, Acc: 87.08%
学习率: 0.000025
✓ 保存最佳模型，验证准确率: 87.08%

Epoch 4/30
--------------------------------------------------
训练 Loss: 0.9298, Acc: 85.77%
验证 Loss: 1.0096, Acc: 84.90%
学习率: 0.000957

Epoch 5/30
--------------------------------------------------
训练 Loss: 0.9147, Acc: 86.76%
验证 Loss: 0.8418, Acc: 88.27%
学习率: 0.000068
✓ 保存最佳模型，验证准确率: 88.27%

Epoch 6/30
--------------------------------------------------
训练 Loss: 0.8821, Acc: 87.50%
验证 Loss: 1.0511, Acc: 84.50%
学习率: 0.000905

Epoch 7/30
--------------------------------------------------
训练 Loss: 0.8670, Acc: 88.31%
验证 Loss: 0.7924, Acc: 89.28%
学习率: 0.000129
✓ 保存最佳模型，验证准确率: 89.28%

Epoch 8/30
--------------------------------------------------
训练 Loss: 0.8492, Acc: 88.72%
验证 Loss: 0.8240, Acc: 88.93%
学习率: 0.000835

Epoch 9/30
--------------------------------------------------
训练 Loss: 0.8377, Acc: 89.12%
验证 Loss: 0.7678, Acc: 89.72%
学习率: 0.000207
✓ 保存最佳模型，验证准确率: 89.72%

Epoch 10/30
--------------------------------------------------
训练 Loss: 0.8230, Acc: 89.41%
验证 Loss: 0.8726, Acc: 88.53%
学习率: 0.000750

Epoch 11/30
--------------------------------------------------
训练 Loss: 0.8183, Acc: 89.73%
验证 Loss: 0.7737, Acc: 90.40%
学习率: 0.000297
✓ 保存最佳模型，验证准确率: 90.40%

Epoch 12/30
--------------------------------------------------
训练 Loss: 0.7997, Acc: 90.15%
验证 Loss: 0.8443, Acc: 88.58%
学习率: 0.000655

Epoch 13/30
--------------------------------------------------
训练 Loss: 0.7994, Acc: 90.15%
验证 Loss: 0.7397, Acc: 90.72%
学习率: 0.000397
✓ 保存最佳模型，验证准确率: 90.72%

Epoch 14/30
--------------------------------------------------
训练 Loss: 0.7940, Acc: 90.53%
验证 Loss: 0.8184, Acc: 89.58%
学习率: 0.000553

Epoch 15/30
--------------------------------------------------
训练 Loss: 0.7788, Acc: 90.67%
验证 Loss: 0.8347, Acc: 91.17%
学习率: 0.000500
✓ 保存最佳模型，验证准确率: 91.17%

Epoch 16/30
--------------------------------------------------
训练 Loss: 0.7815, Acc: 90.65%
验证 Loss: 0.8555, Acc: 90.58%
学习率: 0.000448

Epoch 17/30
--------------------------------------------------
训练 Loss: 0.7690, Acc: 91.00%
验证 Loss: 0.7724, Acc: 91.20%
学习率: 0.000604
✓ 保存最佳模型，验证准确率: 91.20%

Epoch 18/30
--------------------------------------------------
训练 Loss: 0.7623, Acc: 91.31%
验证 Loss: 0.8042, Acc: 89.77%
学习率: 0.000346

Epoch 19/30
--------------------------------------------------
训练 Loss: 0.7581, Acc: 91.45%
验证 Loss: 0.7277, Acc: 91.62%
学习率: 0.000704
✓ 保存最佳模型，验证准确率: 91.62%

Epoch 20/30
--------------------------------------------------
训练 Loss: 0.7471, Acc: 91.52%
验证 Loss: 0.7078, Acc: 91.40%
学习率: 0.000251

Epoch 21/30
--------------------------------------------------
训练 Loss: 0.7440, Acc: 91.77%
验证 Loss: 0.7648, Acc: 91.08%
学习率: 0.000794

Epoch 22/30
--------------------------------------------------
训练 Loss: 0.7428, Acc: 91.76%
验证 Loss: 0.7082, Acc: 91.45%
学习率: 0.000166

Epoch 23/30
--------------------------------------------------
训练 Loss: 0.7347, Acc: 92.03%
验证 Loss: 0.7042, Acc: 91.87%
学习率: 0.000872
✓ 保存最佳模型，验证准确率: 91.87%

Epoch 24/30
--------------------------------------------------
训练 Loss: 0.7303, Acc: 92.11%
验证 Loss: 0.7333, Acc: 91.53%
学习率: 0.000096

Epoch 25/30
--------------------------------------------------
训练 Loss: 0.7229, Acc: 92.40%
验证 Loss: 0.6961, Acc: 91.93%
学习率: 0.000933
✓ 保存最佳模型，验证准确率: 91.93%

Epoch 26/30
--------------------------------------------------
训练 Loss: 0.7228, Acc: 92.33%
验证 Loss: 0.7019, Acc: 92.10%
学习率: 0.000044
✓ 保存最佳模型，验证准确率: 92.10%

Epoch 27/30
--------------------------------------------------
训练 Loss: 0.7180, Acc: 92.42%
验证 Loss: 0.7306, Acc: 91.00%
学习率: 0.000976

Epoch 28/30
--------------------------------------------------
训练 Loss: 0.7189, Acc: 92.46%
验证 Loss: 0.7061, Acc: 92.15%
学习率: 0.000012
✓ 保存最佳模型，验证准确率: 92.15%

Epoch 29/30
--------------------------------------------------
训练 Loss: 0.7191, Acc: 92.66%
验证 Loss: 0.7497, Acc: 90.57%
学习率: 0.000997

Epoch 30/30
--------------------------------------------------
训练 Loss: 0.7125, Acc: 92.63%
验证 Loss: 0.6958, Acc: 92.30%
学习率: 0.000001
✓ 保存最佳模型，验证准确率: 92.30%

==================================================
最终测试
测试准确率: 92.81%
分类报告:
              precision    recall  f1-score   support

 T-shirt/top     0.8531    0.9060    0.8788      1000
     Trouser     0.9930    0.9860    0.9895      1000
    Pullover     0.8761    0.9190    0.8970      1000
       Dress     0.9331    0.9340    0.9335      1000
        Coat     0.8849    0.9070    0.8958      1000
      Sandal     0.9898    0.9740    0.9819      1000
       Shirt     0.8377    0.7280    0.7790      1000
     Sneaker     0.9538    0.9710    0.9623      1000
         Bag     0.9900    0.9870    0.9885      1000
  Ankle boot     0.9671    0.9690    0.9680      1000

    accuracy                         0.9281     10000
   macro avg     0.9279    0.9281    0.9274     10000
weighted avg     0.9279    0.9281    0.9274     10000

模型1准确率: 92.81%

训练集成模型 2/3
开始训练...

Epoch 1/30
--------------------------------------------------
训练 Loss: 2.1059, Acc: 64.31%
验证 Loss: 1.0743, Acc: 80.45%
学习率: 0.000004
✓ 保存最佳模型，验证准确率: 80.45%

Epoch 2/30
--------------------------------------------------
训练 Loss: 1.1209, Acc: 80.13%
验证 Loss: 1.1429, Acc: 79.55%
学习率: 0.000989

Epoch 3/30
--------------------------------------------------
训练 Loss: 1.0135, Acc: 83.51%
验证 Loss: 0.9448, Acc: 85.73%
学习率: 0.000025
✓ 保存最佳模型，验证准确率: 85.73%

Epoch 4/30
--------------------------------------------------
训练 Loss: 0.9630, Acc: 85.18%
验证 Loss: 0.9453, Acc: 83.83%
学习率: 0.000957

Epoch 5/30
--------------------------------------------------
训练 Loss: 0.9356, Acc: 86.29%
验证 Loss: 0.8749, Acc: 88.03%
学习率: 0.000068
✓ 保存最佳模型，验证准确率: 88.03%

Epoch 6/30
--------------------------------------------------
训练 Loss: 0.9072, Acc: 87.03%
验证 Loss: 0.8800, Acc: 87.02%
学习率: 0.000905

Epoch 7/30
--------------------------------------------------
训练 Loss: 0.9084, Acc: 87.69%
验证 Loss: 0.8505, Acc: 88.30%
学习率: 0.000129
✓ 保存最佳模型，验证准确率: 88.30%

Epoch 8/30
--------------------------------------------------
训练 Loss: 0.8802, Acc: 88.14%
验证 Loss: 0.8929, Acc: 87.23%
学习率: 0.000835

Epoch 9/30
--------------------------------------------------
训练 Loss: 0.8613, Acc: 88.65%
验证 Loss: 0.8388, Acc: 89.25%
学习率: 0.000207
✓ 保存最佳模型，验证准确率: 89.25%

Epoch 10/30
--------------------------------------------------
训练 Loss: 0.8640, Acc: 88.65%
验证 Loss: 0.9676, Acc: 87.05%
学习率: 0.000750

Epoch 11/30
--------------------------------------------------
训练 Loss: 0.8336, Acc: 89.28%
验证 Loss: 0.7751, Acc: 90.15%
学习率: 0.000297
✓ 保存最佳模型，验证准确率: 90.15%

Epoch 12/30
--------------------------------------------------
训练 Loss: 0.8125, Acc: 89.81%
验证 Loss: 0.7785, Acc: 89.15%
学习率: 0.000655

Epoch 13/30
--------------------------------------------------
训练 Loss: 0.8091, Acc: 89.72%
验证 Loss: 0.7488, Acc: 89.95%
学习率: 0.000397

Epoch 14/30
--------------------------------------------------
训练 Loss: 0.8126, Acc: 89.97%
验证 Loss: 0.7973, Acc: 89.02%
学习率: 0.000553

Epoch 15/30
--------------------------------------------------
训练 Loss: 0.7915, Acc: 90.47%
验证 Loss: 0.8438, Acc: 90.08%
学习率: 0.000500

Epoch 16/30
--------------------------------------------------
训练 Loss: 0.7815, Acc: 90.64%
验证 Loss: 0.8137, Acc: 90.25%
学习率: 0.000448
✓ 保存最佳模型，验证准确率: 90.25%

Epoch 17/30
--------------------------------------------------
训练 Loss: 0.7734, Acc: 90.89%
验证 Loss: 0.7270, Acc: 90.90%
学习率: 0.000604
✓ 保存最佳模型，验证准确率: 90.90%

Epoch 18/30
--------------------------------------------------
训练 Loss: 0.7725, Acc: 90.93%
验证 Loss: 0.7449, Acc: 90.05%
学习率: 0.000346

Epoch 19/30
--------------------------------------------------
训练 Loss: 0.7616, Acc: 91.35%
验证 Loss: 0.7306, Acc: 91.20%
学习率: 0.000704
✓ 保存最佳模型，验证准确率: 91.20%

Epoch 20/30
--------------------------------------------------
训练 Loss: 0.7570, Acc: 91.20%
验证 Loss: 0.7476, Acc: 90.70%
学习率: 0.000251

Epoch 21/30
--------------------------------------------------
训练 Loss: 0.7529, Acc: 91.56%
验证 Loss: 0.7428, Acc: 91.08%
学习率: 0.000794

Epoch 22/30
--------------------------------------------------
训练 Loss: 0.7502, Acc: 91.65%
验证 Loss: 0.7221, Acc: 90.85%
学习率: 0.000166

Epoch 23/30
--------------------------------------------------
训练 Loss: 0.7399, Acc: 91.82%
验证 Loss: 0.7125, Acc: 90.62%
学习率: 0.000872

Epoch 24/30
--------------------------------------------------
训练 Loss: 0.7349, Acc: 91.88%
验证 Loss: 0.7177, Acc: 91.32%
学习率: 0.000096
✓ 保存最佳模型，验证准确率: 91.32%

Epoch 25/30
--------------------------------------------------
训练 Loss: 0.7319, Acc: 92.11%
验证 Loss: 0.7451, Acc: 90.83%
学习率: 0.000933

Epoch 26/30
--------------------------------------------------
训练 Loss: 0.7306, Acc: 92.09%
验证 Loss: 0.7425, Acc: 91.58%
学习率: 0.000044
✓ 保存最佳模型，验证准确率: 91.58%

Epoch 27/30
--------------------------------------------------
训练 Loss: 0.7206, Acc: 92.36%
验证 Loss: 0.6998, Acc: 91.17%
学习率: 0.000976

Epoch 28/30
--------------------------------------------------
训练 Loss: 0.7262, Acc: 92.25%
验证 Loss: 0.7295, Acc: 91.12%
学习率: 0.000012

Epoch 29/30
--------------------------------------------------
训练 Loss: 0.7171, Acc: 92.48%
验证 Loss: 0.7158, Acc: 91.22%
学习率: 0.000997

Epoch 30/30
--------------------------------------------------
训练 Loss: 0.7135, Acc: 92.47%
验证 Loss: 0.6988, Acc: 91.95%
学习率: 0.000001
✓ 保存最佳模型，验证准确率: 91.95%

==================================================
最终测试
测试准确率: 92.46%
分类报告:
              precision    recall  f1-score   support

 T-shirt/top     0.8701    0.8710    0.8706      1000
     Trouser     0.9920    0.9890    0.9905      1000
    Pullover     0.8609    0.9160    0.8876      1000
       Dress     0.9307    0.9260    0.9283      1000
        Coat     0.9007    0.8800    0.8902      1000
      Sandal     0.9879    0.9830    0.9855      1000
       Shirt     0.7908    0.7600    0.7751      1000
     Sneaker     0.9468    0.9790    0.9626      1000
         Bag     0.9851    0.9890    0.9870      1000
  Ankle boot     0.9805    0.9530    0.9665      1000

    accuracy                         0.9246     10000
   macro avg     0.9245    0.9246    0.9244     10000
weighted avg     0.9245    0.9246    0.9244     10000

模型2准确率: 92.46%

训练集成模型 3/3
开始训练...

Epoch 1/30
--------------------------------------------------
训练 Loss: 2.0624, Acc: 64.27%
验证 Loss: 1.1111, Acc: 81.18%
学习率: 0.000004
✓ 保存最佳模型，验证准确率: 81.18%

Epoch 2/30
--------------------------------------------------
训练 Loss: 1.1532, Acc: 80.06%
验证 Loss: 1.0940, Acc: 81.95%
学习率: 0.000989
✓ 保存最佳模型，验证准确率: 81.95%

Epoch 3/30
--------------------------------------------------
训练 Loss: 1.0525, Acc: 83.40%
验证 Loss: 0.9131, Acc: 86.13%
学习率: 0.000025
✓ 保存最佳模型，验证准确率: 86.13%

Epoch 4/30
--------------------------------------------------
训练 Loss: 1.0071, Acc: 85.05%
验证 Loss: 0.8850, Acc: 83.98%
学习率: 0.000957

Epoch 5/30
--------------------------------------------------
训练 Loss: 0.9661, Acc: 86.25%
验证 Loss: 0.8836, Acc: 87.48%
学习率: 0.000068
✓ 保存最佳模型，验证准确率: 87.48%

Epoch 6/30
--------------------------------------------------
训练 Loss: 0.9407, Acc: 86.69%
验证 Loss: 0.8738, Acc: 84.48%
学习率: 0.000905

Epoch 7/30
--------------------------------------------------
训练 Loss: 0.9175, Acc: 87.72%
验证 Loss: 0.7924, Acc: 88.83%
学习率: 0.000129
✓ 保存最佳模型，验证准确率: 88.83%

Epoch 8/30
--------------------------------------------------
训练 Loss: 0.8987, Acc: 88.05%
验证 Loss: 0.8383, Acc: 88.65%
学习率: 0.000835

Epoch 9/30
--------------------------------------------------
训练 Loss: 0.8938, Acc: 88.66%
验证 Loss: 0.8083, Acc: 89.72%
学习率: 0.000207
✓ 保存最佳模型，验证准确率: 89.72%

Epoch 10/30
--------------------------------------------------
训练 Loss: 0.8723, Acc: 88.87%
验证 Loss: 0.8709, Acc: 88.15%
学习率: 0.000750

Epoch 11/30
--------------------------------------------------
训练 Loss: 0.8503, Acc: 89.48%
验证 Loss: 0.8064, Acc: 89.72%
学习率: 0.000297

Epoch 12/30
--------------------------------------------------
训练 Loss: 0.8416, Acc: 89.70%
验证 Loss: 0.9069, Acc: 88.52%
学习率: 0.000655

Epoch 13/30
--------------------------------------------------
训练 Loss: 0.8304, Acc: 89.61%
验证 Loss: 0.7562, Acc: 90.23%
学习率: 0.000397
✓ 保存最佳模型，验证准确率: 90.23%

Epoch 14/30
--------------------------------------------------
训练 Loss: 0.8311, Acc: 90.18%
验证 Loss: 0.7844, Acc: 89.67%
学习率: 0.000553

Epoch 15/30
--------------------------------------------------
训练 Loss: 0.8134, Acc: 90.28%
验证 Loss: 0.7275, Acc: 90.92%
学习率: 0.000500
✓ 保存最佳模型，验证准确率: 90.92%

Epoch 16/30
--------------------------------------------------
训练 Loss: 0.7988, Acc: 90.62%
验证 Loss: 0.7490, Acc: 89.47%
学习率: 0.000448

Epoch 17/30
--------------------------------------------------
训练 Loss: 0.7855, Acc: 90.90%
验证 Loss: 0.7614, Acc: 90.65%
学习率: 0.000604

Epoch 18/30
--------------------------------------------------
训练 Loss: 0.7907, Acc: 91.01%
验证 Loss: 0.8458, Acc: 89.83%
学习率: 0.000346

Epoch 19/30
--------------------------------------------------
训练 Loss: 0.7778, Acc: 91.28%
验证 Loss: 0.7290, Acc: 90.33%
学习率: 0.000704

Epoch 20/30
--------------------------------------------------
训练 Loss: 0.7770, Acc: 91.08%
验证 Loss: 0.8137, Acc: 90.03%
学习率: 0.000251

Epoch 21/30
--------------------------------------------------
训练 Loss: 0.7712, Acc: 91.32%
验证 Loss: 0.7441, Acc: 90.77%
学习率: 0.000397

Epoch 22/30
--------------------------------------------------
训练 Loss: 0.7526, Acc: 91.78%
验证 Loss: 0.7323, Acc: 91.40%
学习率: 0.000166
✓ 保存最佳模型，验证准确率: 91.40%

Epoch 23/30
--------------------------------------------------
训练 Loss: 0.7532, Acc: 91.83%
验证 Loss: 0.7345, Acc: 91.10%
学习率: 0.000872

Epoch 24/30
--------------------------------------------------
训练 Loss: 0.7564, Acc: 91.86%
验证 Loss: 0.7072, Acc: 91.63%
学习率: 0.000096
✓ 保存最佳模型，验证准确率: 91.63%

Epoch 25/30
--------------------------------------------------
训练 Loss: 0.7510, Acc: 91.80%
验证 Loss: 0.7253, Acc: 91.38%
学习率: 0.000933

Epoch 26/30
--------------------------------------------------
训练 Loss: 0.7509, Acc: 91.89%
验证 Loss: 0.6999, Acc: 92.17%
学习率: 0.000044
✓ 保存最佳模型，验证准确率: 92.17%

Epoch 27/30
--------------------------------------------------
训练 Loss: 0.7443, Acc: 92.12%
验证 Loss: 0.6920, Acc: 91.47%
学习率: 0.000976

Epoch 28/30
--------------------------------------------------
训练 Loss: 0.7389, Acc: 92.18%
验证 Loss: 0.7144, Acc: 91.72%
学习率: 0.000012

Epoch 29/30
--------------------------------------------------
训练 Loss: 0.7474, Acc: 92.04%
验证 Loss: 0.7256, Acc: 91.08%
学习率: 0.000997

Epoch 30/30
--------------------------------------------------
训练 Loss: 0.7299, Acc: 92.43%
验证 Loss: 0.6987, Acc: 91.87%
学习率: 0.000001

==================================================
最终测试
测试准确率: 92.58%
分类报告:
              precision    recall  f1-score   support

 T-shirt/top     0.8573    0.8890    0.8729      1000
     Trouser     0.9910    0.9870    0.9890      1000
    Pullover     0.8870    0.9180    0.9022      1000
       Dress     0.9133    0.9270    0.9201      1000
        Coat     0.8662    0.9260    0.8951      1000
      Sandal     0.9878    0.9710    0.9793      1000
       Shirt     0.8422    0.7100    0.7705      1000
     Sneaker     0.9582    0.9630    0.9606      1000
         Bag     0.9920    0.9930    0.9925      1000
  Ankle boot     0.9587    0.9740    0.9663      1000

    accuracy                         0.9258     10000
   macro avg     0.9254    0.9258    0.9248     10000
weighted avg     0.9254    0.9258    0.9248     10000

模型3准确率: 92.58%

集成模型测试准确率: 93.28%
比单个模型提升: -0.11%

==================================================
训练完成！
生成的文件:
  - best_model.pth (最佳模型)
  - final_model.pth (最终模型)
  - ensemble_model.pth (集成模型, 如果成功)
  - training_history.png (训练历史图)
  - confusion_matrix.png (混淆矩阵)
  - misclassified_examples.png (错误分类示例)
